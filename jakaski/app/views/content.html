#{extends 'main.html' /}
  #{set 'moreStyles'}
  <link rel="stylesheet" href="@{'/public/stylesheets/dhtmlxscheduler.css'}" type="text/css" charset="utf-8">
  #{/set}
  #{set 'moreScripts'}
  <script src="@{'/public/javascripts/dhtmlxscheduler.js'}" type="text/javascript" charset="utf-8"></script>
  <script src="@{'/public/javascripts/dhtmlxscheduler_timeline.js'}" type="text/javascript" charset="utf-8"></script>
  #{/set}

<div class="navbar navbar-fixed-top">
  
  <div class="navbar-inner">
    
    <div class="container">
      
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> 
        <span class="icon-bar"></span> 
        <span class="icon-bar"></span> 
        <span class="icon-bar"></span>        
      </a>
      
      <a class="brand">SkiSchool Manager</a>
      
      <div class="nav-collapse">
      
        <ul class="nav pull-right">
          <li>
            <a href="http://wbpreview.com/previews/WB00U8L84/#"><span class="badge badge-warning">7</span></a>
          </li>
          
          <li class="divider-vertical"></li>
          
          <li class="dropdown">
            
            <a data-toggle="dropdown" class="dropdown-toggle " href="#">
              ${user.email}<b class="caret"></b>              
            </a>
            
            <ul class="dropdown-menu">
              <li>
                <a href="http://wbpreview.com/previews/WB00U8L84/account.html"><i class="icon-user"></i> Account Setting  </a>
              </li>
              
              <li>
                <a href="http://wbpreview.com/previews/WB00U8L84/change_password.html"><i class="icon-lock"></i> Change Password</a>
              </li>
              
              <li class="divider"></li>
              
              <li>
                <a href="@{Secure.logout()}"><i class="icon-off"></i> Logout</a>
              </li>
            </ul>
          </li>
        </ul>
        
      </div> <!-- /nav-collapse -->
      
    </div> <!-- /container -->
    
  </div> <!-- /navbar-inner -->
  
</div> <!-- /navbar -->




<div id="content">
  
  <div class="container">
    
    <div class="row">
      
      <div class="span2">
        
        <div class="account-container">
        
          <div class="account-details">
          
            <span class="account-name">${user.toString()}</span>
            
            <span class="account-role">${user.role}</span>
            
            <span class="account-actions">
              <a href="javascript:;">Profile</a> |
              
              <a href="javascript:;">Edit Settings</a>
            </span>
          
          </div> <!-- /account-details -->
        
        </div> <!-- /account-container -->
        
        <hr>
        
        <ul id="main-nav" class="nav nav-tabs nav-stacked">
          
          <li class="active">
            <a href="./Dashboard - Bootstrap Admin_files/Dashboard - Bootstrap Admin.htm">
              <i class="icon-calendar"></i>
             &{'timetable'}     
            </a>
          </li>
          
          <li>
            <a href="http://wbpreview.com/previews/WB00U8L84/faq.html">
              <i class="icon-pushpin"></i>
              FAQ 
            </a>
          </li>
          
          <li>
            <a href="http://wbpreview.com/previews/WB00U8L84/plans.html">
              <i class="icon-th-list"></i>
              Pricing Plans   
            </a>
          </li>
          
          <li>
            <a href="http://wbpreview.com/previews/WB00U8L84/grid.html">
              <i class="icon-th-large"></i>
              Grid Layout 
              <span class="label label-warning pull-right">5</span>
            </a>
          </li>
          
          <li>
            <a href="http://wbpreview.com/previews/WB00U8L84/charts.html">
              <i class="icon-signal"></i>
              Charts  
            </a>
          </li>
          
          <li>
            <a href="http://wbpreview.com/previews/WB00U8L84/account.html">
              <i class="icon-user"></i>
              User Account              
            </a>
          </li>
          
        </ul> 
        
        <hr>
        
        <div class="sidebar-extra">
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud.</p>
        </div> <!-- .sidebar-extra -->
        
        <br>
    
      </div> <!-- /span2 -->
      		<div class="span10">
				
				<h1 class="page-title">
					<i class="icon-calendar"></i>
					&{'timetable'}					
				</h1>
        
  <div class="widget">
  <div class="widget-content">        
  <div id="scheduler_here" class="dhx_cal_container" style='width: 100%; height: 600px'>
  <div class="dhx_cal_navline">
    <div class="dhx_cal_prev_button">&nbsp;</div>
    <div class="dhx_cal_next_button">&nbsp;</div>
    <div class="dhx_cal_today_button"></div>
    <div class="dhx_cal_date"></div>
    <div class="dhx_cal_tab" name="timeline_tab" style="right: 280px;">Timeline</div>
    <div class="dhx_cal_tab" name="day_tab" style="right: 204px;"></div>
    <div class="dhx_cal_tab" name="week_tab" style="right: 140px;"></div>
    <div class="dhx_cal_tab" name="month_tab" style="right: 76px;"></div>
  </div>
  <div class="dhx_cal_header"></div>
  <div class="dhx_cal_data"></div>
</div>

<script>
    scheduler.createTimelineView({
        name: "timeline",
        x_unit: "minute",
        x_date: "%H:%i",
        x_step: 60,
        x_start: 9,
        x_size: 10,
        y_unit:[  
            {key:45, label:"James Smith"},
            {key:2, label:"John Williams"},
            {key:3, label:"David Miller"},
            {key:4, label:"Linda Brown"}  
        ],
        y_property:"section_id",
        render: "bar"
    });
    scheduler.init('scheduler_here', null, "timeline");

    var createAvailability = #{jsRoute @Application.createAvailability() /};

    scheduler.attachEvent("onEventAdded", function(eventId, eventObject) {
        var convert = scheduler.date.date_to_str("%Y-%m-%d %H:%i");
        var dataObject = jQuery.extend(true, {}, eventObject);

        dataObject['start_date'] = convert(dataObject['start_date']);
        dataObject['end_date'] = convert(dataObject['end_date']);

        $.ajax({
            url : createAvailability.url(),
            type : createAvailability.method,
            contentType : 'application/json; charset=UTF-8',
            data : JSON.stringify(dataObject),
            dataType : "json",
            success : function(data){
                scheduler.changeEventId(eventId, data.id);
            }
        });
    });
    scheduler.attachEvent("onEventChanged", function(eventId,eventObject){
        alert("event_id: " + eventObject.id);
    });
</script>
            </div>
         </div>
          
      </div> <!-- /span2 -->
   
    </div> <!-- /row -->
    
  </div> <!-- /container -->
  
</div> <!-- /content -->
          
  
<div id="footer">
  
  <div class="container">       
    <hr>
    <p>Â© 2012 Jaka Ski.</p>
  </div> <!-- /container -->
  
</div> <!-- /footer -->